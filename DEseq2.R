library(DESeq2)cts = as.matrix(read.table("count.matrix", header = T, row.names = "Geneid"))coldata = read.csv("sample.csv", header = T, row.names = "Sample")coldata$condition = factor(coldata$condition)coldata$type = factor(coldata$type)dds <- DESeqDataSetFromMatrix(countData = cts, colData = coldata, design = ~ condition)dds <- DESeq(dds)res <- results(dds)resOrdered <- res[order(res$padj),]library(biomaRt)res <- results(dds)resOrdered <- res[order(res$padj),]data=read.table("count.matrix", header = T, row.names = "Geneid")count_res = merge(data, as.data.frame(resOrdered), by=0, all=T)ensembl = useEnsembl(biomart="ensembl", dataset="mmusculus_gene_ensembl")id2symbol = getBM(attributes = c("ensembl_gene_id", "mgi_symbol"), filters = "ensembl_gene_id", values = count_res$Row.names, mart = ensembl)names(id2symbol) = c("Geneid", "symbol")names(count_res)[1] = "Geneid"final_table = merge(id2symbol, count_res, by="Geneid", all=T)final_table = final_table[order(final_table$padj),]write.table(final_table, file = "Day3_vs_Day10_results.csv", quote = F, row.names = F, sep = "\t")res=final_tablepdf("Volcanoplot.pdf")with(res, plot(-log2FoldChange, -log10(pvalue), pch=20, main="Volcano plot", xlim=c(-7,7), ylim=c(0,40), col="darkgray"))with(subset(res, padj<.05 ), points(-log2FoldChange, -log10(pvalue), pch=20, col="darkgray"))with(subset(res, abs(log2FoldChange)>0.5), points(-log2FoldChange, -log10(pvalue), pch=20, col="darkgray"))with(subset(res, padj<.05 & (-log2FoldChange)>1), points(-log2FoldChange, -log10(pvalue), pch=20, col="firebrick"))with(subset(res, padj<.05 & (-log2FoldChange)< -1), points(-log2FoldChange, -log10(pvalue), pch=20, col="black"))dev.off()